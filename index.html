<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å°é³„é±¼è·³ä»™äººæŒ - ç»ˆæç‰ˆ</title>
    <!-- å¼•å…¥åƒç´ å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #000; /* èƒŒæ™¯è®¾ä¸ºé»‘è‰²ï¼Œæ›´æœ‰è¡—æœºæ„Ÿ */
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
        }

        /* 1. å¼€å± Logo æ ·å¼ */
        #splash-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Press Start 2P', cursive;
            font-size: 3rem;
            color: #ff0000;
            text-shadow: 4px 4px 0 #000;
            opacity: 0;
            z-index: 100;
            pointer-events: none;
            animation: splashAnim 1.5s ease-in-out forwards;
        }

        @keyframes splashAnim {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2); }
        }

        /* 2. å¼€å§‹æŒ‰é’®æ ·å¼ */
        #start-screen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 90;
            display: none; /* é»˜è®¤éšè—ï¼Œç­‰Logoæ’­å®Œå†æ˜¾ç¤º */
        }

        #start-btn {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            padding: 20px 40px;
            background-color: #222;
            color: #fff;
            border: 4px solid #fff;
            box-shadow: 8px 8px 0 #000;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
            outline: none;
        }

        #start-btn:hover {
            background-color: #444;
            transform: translate(-2px, -2px);
            box-shadow: 10px 10px 0 #000;
        }

        #start-btn:active {
            transform: translate(4px, 4px);
            box-shadow: 0px 0px 0 #000;
        }

        /* æ¸¸æˆä¸»å®¹å™¨ */
        #game {
            width: 800px;
            height: 250px;
            border: 2px solid #333;
            position: relative;
            overflow: hidden;
            background: linear-gradient(#87CEEB, #E0F6FF);
            opacity: 0.8; /* å¼€å§‹å‰ç¨å¾®æš—ä¸€ç‚¹ */
            transition: opacity 0.5s;
        }
        
        #game.active {
            opacity: 1; /* å¼€å§‹åå˜äº® */
        }

        /* ğŸŠ é³„é±¼ */
        #dino {
            width: 70px;
            height: 60px;
            position: absolute;
            bottom: 0;
            left: 50px;
            display: flex;
            flex-wrap: wrap;
            z-index: 10;
        }
        .dino-pixel { width: 8px; height: 8px; box-sizing: border-box; }
        .dino-pixel.green { background-color: #1e7a1e; }
        .dino-pixel.light-green { background-color: #32cd32; }
        .dino-pixel.black { background-color: #000; }
        .dino-pixel.empty { background-color: transparent; }

        /* ğŸŒµ ä»™äººæŒå®¹å™¨ */
        #cactus-container {
            position: absolute;
            bottom: 0;
            left: 850px;
            height: 100%;
            display: flex;
            align-items: flex-end;
        }
        
        /* åŸºç¡€ä»™äººæŒ */
        .cactus {
            width: 40px;
            height: 70px;
            display: flex;
            flex-wrap: wrap;
            z-index: 5;
            margin-right: -10px; /* é‡å é—´è· */
        }
        /* åŒå€é«˜ä»™äººæŒ */
        .cactus.tall {
            height: 140px;
            align-self: flex-end;
        }
        
        .cactus-pixel { width: 8px; height: 8px; box-sizing: border-box; }
        .cactus-pixel.green { background-color: #2e8b57; }
        .cactus-pixel.dark-green { background-color: #006400; }
        .cactus-pixel.empty { background-color: transparent; }

        /* UI */
        .score-panel {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            border: 2px solid #333;
            padding: 5px 10px;
            background: rgba(255,255,255,0.8);
            z-index: 20;
        }
        #ground {
            width: 100%;
            height: 5px;
            background-color: #666;
            position: absolute;
            bottom: 0;
            z-index: 1;
        }
        
        /* äº‘æœµåŠ¨ç”» */
        .cloud { position: absolute; background: white; border-radius: 50%; opacity: 0.8; }
        .cloud-group { position: absolute; top: 30px; right: -100px; animation: cloudMove 20s linear infinite; }
        .cloud-group:nth-child(2) { top: 60px; right: -150px; animation-duration: 25s; animation-delay: 5s; transform: scale(0.8); }
        .cloud-group:nth-child(3) { top: 40px; right: -200px; animation-duration: 30s; animation-delay: 10s; transform: scale(0.7); }
        @keyframes cloudMove { from { right: -100px; } to { right: 900px; } }
    </style>
</head>
<body>

    <!-- Logo å±‚ -->
    <div id="splash-screen">ALAN PRESENTS</div>

    <!-- å¼€å§‹æŒ‰é’®å±‚ -->
    <div id="start-screen">
        <button id="start-btn">START GAME</button>
    </div>

    <!-- æ¸¸æˆå±‚ -->
    <div id="game">
        <!-- ğŸŠ é³„é±¼æ¨¡å‹ -->
        <div id="dino">
            <div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel empty"></div><div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel black"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel empty"></div><div class="dino-pixel light-green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
            <div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel light-green"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div><div class="dino-pixel empty"></div>
        </div>

        <!-- ğŸŒµ ä»™äººæŒç»„ -->
        <div id="cactus-container">
            <div class="cactus" id="c1">
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
            </div>
            <div class="cactus" id="c2">
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
            </div>
            <div class="cactus" id="c3">
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div><div class="cactus-pixel empty"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel empty"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel empty"></div><div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
                 <div class="cactus-pixel green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div><div class="cactus-pixel dark-green"></div>
            </div>
        </div>

        <div class="score-panel">
            <div>ğŸ† High Score: <span id="high-score">0</span></div>
            <div>ğŸ® Current Score: <span id="current-score">0</span></div>
        </div>
        <div id="ground"></div>
        
        <!-- è£…é¥° -->
        <div class="cloud-group"><div class="cloud" style="width:30px;height:30px;top:0;left:0"></div><div class="cloud" style="width:25px;height:25px;top:5px;left:20px"></div></div>
        <div class="cloud-group"><div class="cloud" style="width:25px;height:25px;top:0;left:0"></div><div class="cloud" style="width:20px;height:20px;top:5px;left:15px"></div></div>
    </div>

    <script>
        // --- DOM å…ƒç´ è·å– ---
        const splashScreen = document.getElementById('splash-screen');
        const startScreen = document.getElementById('start-screen');
        const startBtn = document.getElementById('start-btn');
        const gameContainer = document.getElementById('game');
        const dino = document.getElementById('dino');
        const container = document.getElementById('cactus-container');
        const c1 = document.getElementById('c1');
        const c2 = document.getElementById('c2');
        const c3 = document.getElementById('c3');
        const currentScoreElement = document.getElementById('current-score');
        const highScoreElement = document.getElementById('high-score');

        // --- æ¸¸æˆçŠ¶æ€å˜é‡ ---
        let gameStarted = false; // æ–°å¢ï¼šæ§åˆ¶æ¸¸æˆæ˜¯å¦å¼€å§‹
        let score = 0;
        let isJumping = false;
        let jumpHeight = 0;
        let gameOver = false;
        let currentObstacleCount = 1; 
        let isTall = false;

        // --- ç‰©ç†å‚æ•° ---
        let baseJumpSpeed = 20;
        let currentJumpSpeed = baseJumpSpeed;
        let baseGravity = 0.7;
        let currentGravity = baseGravity;
        
        let baseSpeed = 5;
        let cactusSpeed = baseSpeed;
        const maxSpeed = baseSpeed * 2; 
        let speedMultiplier = 1;

        // --- åˆå§‹åŒ– ---
        let highScore = localStorage.getItem('dinoHighScore') || 0;
        highScoreElement.textContent = highScore;

        // --- æµç¨‹æ§åˆ¶é€»è¾‘ ---
        
        // 1. LogoåŠ¨ç”»ç»“æŸåæ˜¾ç¤ºå¼€å§‹æŒ‰é’®
        setTimeout(() => {
            splashScreen.style.display = 'none'; // éšè—Logo
            startScreen.style.display = 'block'; // æ˜¾ç¤ºå¼€å§‹ç•Œé¢
        }, 1600); // å¯¹åº” CSS åŠ¨ç”»æ—¶é•¿ 1.5s

        // 2. å¼€å§‹æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        startBtn.addEventListener('click', () => {
            startGame();
        });

        // æ”¯æŒæŒ‰ç©ºæ ¼é”®å¼€å§‹
        document.addEventListener('keydown', (e) => {
            if ((e.code === 'Space' || e.key === ' ') && !gameStarted && !gameOver) {
                startGame();
            }
        });

        function startGame() {
            if (gameStarted) return;
            
            gameStarted = true;
            startScreen.style.display = 'none'; // éšè—æŒ‰é’®
            gameContainer.classList.add('active'); // è®©æ¸¸æˆç”»é¢å˜äº®
            generateObstacle(); // ç”Ÿæˆç¬¬ä¸€ä¸ªéšœç¢ç‰©
            gameLoop(); // å¯åŠ¨ä¸»å¾ªç¯
        }

        // --- æ¸¸æˆæ ¸å¿ƒé€»è¾‘ (ä¿æŒä¸å˜) ---

        // é”®ç›˜è·³è·ƒæ§åˆ¶
        document.addEventListener('keydown', (e) => {
            if ((e.code === 'Space' || e.key === ' ') && !isJumping && gameStarted && !gameOver) {
                isJumping = true;
                currentJumpSpeed = baseJumpSpeed * (0.8 + speedMultiplier * 0.2);
                jump();
            }
        });

        function jump() {
            if (isJumping && !gameOver) {
                jumpHeight += currentJumpSpeed;
                dino.style.bottom = `${jumpHeight}px`;
                currentJumpSpeed -= currentGravity;

                if (jumpHeight <= 0) {
                    jumpHeight = 0;
                    dino.style.bottom = '0px';
                    isJumping = false;
                    currentJumpSpeed = baseJumpSpeed;
                } else {
                    requestAnimationFrame(jump);
                }
            }
        }

        function generateObstacle() {
            c1.style.display = 'none';
            c2.style.display = 'none';
            c3.style.display = 'none';
            c2.classList.remove('tall');
            container.style.left = '850px';

            if (score < 80) {
                c1.style.display = 'flex';
                currentObstacleCount = 1;
            } else if (score < 300) {
                if (Math.random() > 0.5) {
                    c1.style.display = 'flex';
                    currentObstacleCount = 1;
                } else {
                    c1.style.display = 'flex';
                    c2.style.display = 'flex';
                    currentObstacleCount = 2;
                }
            } else {
                c1.style.display = 'flex';
                c2.style.display = 'flex';
                c3.style.display = 'flex';
                currentObstacleCount = 3;
                
                if (Math.random() > 0.4) {
                    c2.classList.add('tall');
                    isTall = true;
                } else {
                    isTall = false;
                }
            }
        }

        // æ ¸å¿ƒä¿®å¤ï¼šåŸºäºé€»è¾‘çš„ç¢°æ’æ£€æµ‹
        function checkCollision() {
            const dinoRect = dino.getBoundingClientRect();
            
            // 1. åªè¦è·³èµ·æ¥å°±ä¸æ’
            if (dinoRect.bottom - dinoRect.top < 50) { 
                return false;
            }

            // 2. å¼ºåˆ¶æ£€æµ‹å½“å‰é˜¶æ®µåº”è¯¥å­˜åœ¨çš„ç‰©ä½“
            if (checkSingleCactus(c1, dinoRect)) return true;
            if (currentObstacleCount >= 2 && checkSingleCactus(c2, dinoRect)) return true;
            if (currentObstacleCount === 3 && checkSingleCactus(c3, dinoRect)) return true;

            return false;
        }

        function checkSingleCactus(cactus, dinoRect) {
            const cRect = cactus.getBoundingClientRect();
            const hitX = dinoRect.right > cRect.left + 5 && dinoRect.left < cRect.right - 5;
            const hitY = dinoRect.bottom > cRect.top;
            return hitX && hitY;
        }

        function gameLoop() {
            if (gameOver) return;
            if (!gameStarted) return; // å¦‚æœæ²¡å¼€å§‹ï¼Œä¸æ‰§è¡Œå¾ªç¯

            // é€Ÿåº¦æ§åˆ¶
            let targetMultiplier = 1 + (Math.floor(score / 100) * 0.2);
            if (targetMultiplier > 2) targetMultiplier = 2;
            
            if (speedMultiplier < targetMultiplier) {
                speedMultiplier += 0.005;
                if(speedMultiplier > targetMultiplier) speedMultiplier = targetMultiplier;
                cactusSpeed = baseSpeed * speedMultiplier;
                currentGravity = baseGravity * speedMultiplier * 1.1;
            }

            // ç§»åŠ¨
            let containerLeft = parseInt(window.getComputedStyle(container).left);
            container.style.left = `${containerLeft - cactusSpeed}px`;

            // è®¡åˆ†
            if (containerLeft < -100) {
                if (currentObstacleCount === 3 && isTall) score += 30;
                else if (currentObstacleCount >= 2) score += 20;
                else score += 10;

                currentScoreElement.textContent = score;
                
                if (score > highScore) {
                    highScore = score;
                    highScoreElement.textContent = highScore;
                    localStorage.setItem('dinoHighScore', highScore);
                }
                
                generateObstacle();
            }

            // ç¢°æ’æ£€æµ‹
            if (checkCollision()) {
                gameOver = true;
                setTimeout(() => {
                    alert(`Game Over!\nScore: ${score}\nHigh Score: ${highScore}`);
                    window.location.reload(true); // åˆ·æ–°é¡µé¢é‡æ¥
                }, 50);
            }

            requestAnimationFrame(gameLoop);
        }
    </script>
</body>
</html>